---


- name: apache
  hosts: all
  become: yes
  gather_facts: false


  tasks:

    - name: install latest version of Apache HTTP server
      package:
        name: "{{ item }}"
        state: latest
        update_cache: yes
      with_items: "{{ apache_packages }}"

    - name: Set servername
      lineinfile:
        path: /etc/apache2/conf-available/servername.conf
        line: "ServerName localhost"
        state: present
        create: yes

    - name: Override servername conf
      command: a2enconf servername
      notify: reload apache

    - name: Check for needed Apache modules
      apache2_module:
        name: "{{ item }}"
        state: present
      notify: reload apache
      with_items: "{{ apache_modules }}"

    # PLACHOLDER for adding in a custom Apache Vhost to handle reverse proxying etc

    # PLACEHOLDER for ports.conf configuration

    # PLACEHOLDER for /etc/hosts file

    # PLACEHOLDER for SSL certs

    # PLACEHOLDER for /etc/hostname file

  handlers:
    - name: reload apache
      service: name=apache2 state=reloaded

